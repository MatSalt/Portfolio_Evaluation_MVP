"""
í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ API ë°ì´í„° ëª¨ë¸

ì´ ëª¨ë“ˆì€ í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ APIì˜ ìš”ì²­/ì‘ë‹µì„ ìœ„í•œ Pydantic ëª¨ë¸ë“¤ì„ ì •ì˜í•©ë‹ˆë‹¤.
ë§ˆí¬ë‹¤ìš´ í…ìŠ¤íŠ¸ ì¶œë ¥ ë°©ì‹ì— ìµœì í™”ëœ ê°„ë‹¨í•œ êµ¬ì¡°ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
"""

from pydantic import BaseModel, Field, field_validator
from typing import Optional
from enum import Enum
import time

class AnalysisStatus(str, Enum):
    """ë¶„ì„ ìƒíƒœ"""
    PENDING = "pending"
    PROCESSING = "processing"
    COMPLETED = "completed"
    FAILED = "failed"

class AnalysisRequest(BaseModel):
    """ë¶„ì„ ìš”ì²­ ì •ë³´"""
    filename: Optional[str] = Field(None, description="íŒŒì¼ëª…")
    file_size: Optional[int] = Field(None, description="íŒŒì¼ í¬ê¸° (bytes)")
    content_type: Optional[str] = Field(None, description="íŒŒì¼ íƒ€ì…")

class AnalysisResponse(BaseModel):
    """ë§ˆí¬ë‹¤ìš´ í…ìŠ¤íŠ¸ ë¶„ì„ ê²°ê³¼ ì‘ë‹µ"""
    content: str = Field(..., description="expected_result.mdì™€ ë™ì¼í•œ í˜•ì‹ì˜ ë§ˆí¬ë‹¤ìš´ í…ìŠ¤íŠ¸")
    processing_time: float = Field(..., description="ì²˜ë¦¬ ì‹œê°„ (ì´ˆ)")
    request_id: str = Field(..., description="ìš”ì²­ ID")
    images_processed: int = Field(default=1, description="ì²˜ë¦¬ëœ ì´ë¯¸ì§€ ìˆ˜")
    
    @field_validator('content')
    @classmethod
    def validate_content(cls, v):
        if not v or len(v.strip()) < 100:
            raise ValueError('ë¶„ì„ ê²°ê³¼ëŠ” ìµœì†Œ 100ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
        return v.strip()

class ErrorResponse(BaseModel):
    """ì—ëŸ¬ ì‘ë‹µ"""
    error: str = Field(..., description="ì—ëŸ¬ ë©”ì‹œì§€")
    detail: Optional[str] = Field(None, description="ìƒì„¸ ì—ëŸ¬ ì •ë³´")
    code: Optional[str] = Field(None, description="ì—ëŸ¬ ì½”ë“œ")
    timestamp: str = Field(default_factory=lambda: time.strftime("%Y-%m-%d %H:%M:%S"), description="ë°œìƒ ì‹œê°„")

# ê²€ì¦ìš© ìƒ˜í”Œ ë§ˆí¬ë‹¤ìš´ ë°ì´í„°
SAMPLE_MARKDOWN_CONTENT = """**AI ì´í‰:** ìƒ˜í”Œ í¬íŠ¸í´ë¦¬ì˜¤ëŠ” **'ê¸°ìˆ  í˜ì‹  ì¤‘ì‹¬í˜•'** ì „ëµì„ ë”°ë¥´ê³  ìˆìœ¼ë©°, ë†’ì€ ì„±ì¥ ì ì¬ë ¥ì„ ë³´ìœ í•˜ê³  ìˆìœ¼ë‚˜ **ë³€ë™ì„±ì— ë‹¤ì†Œ ì·¨ì•½**í•©ë‹ˆë‹¤.

**í¬íŠ¸í´ë¦¬ì˜¤ ì¢…í•© ë¦¬ë‹ˆì•„ ìŠ¤ì½”ì–´: 75 / 100**

**3ëŒ€ í•µì‹¬ ê¸°ì¤€ ìŠ¤ì½”ì–´:**

- **ì„±ì¥ ì ì¬ë ¥:** 85 / 100
- **ì•ˆì •ì„± ë° ë°©ì–´ë ¥:** 60 / 100
- **ì „ëµì  ì¼ê´€ì„±:** 80 / 100

**[1] í¬íŠ¸í´ë¦¬ì˜¤ ë¦¬ë‹ˆì•„ ìŠ¤ì½”ì–´ ì‹¬ì¸µ ë¶„ì„**

**1.1 ì„±ì¥ ì ì¬ë ¥ ë¶„ì„ (85 / 100): í˜ì‹  ê¸°ìˆ ì— ëŒ€í•œ ê°•ë ¥í•œ ì§‘ì¤‘**

ìƒ˜í”Œ í¬íŠ¸í´ë¦¬ì˜¤ëŠ” AI, í´ë¼ìš°ë“œ, ë°˜ë„ì²´ ë“± ë¯¸ë˜ ì„±ì¥ ë™ë ¥ì´ ë  ê¸°ìˆ  ë¶„ì•¼ì˜ ì„ ë‘ ê¸°ì—…ë“¤ì— ì§‘ì¤‘ íˆ¬ìë˜ì–´ ìˆì–´ ë†’ì€ ì„±ì¥ ì ì¬ë ¥ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. íŠ¹íˆ ê¸°ìˆ  í˜ì‹ ì„ ì£¼ë„í•˜ëŠ” ê¸°ì—…ë“¤ì˜ ë¹„ì¤‘ì´ ì „ì²´ í¬íŠ¸í´ë¦¬ì˜¤ì˜ ìƒë‹¹ ë¶€ë¶„ì„ ì°¨ì§€í•˜ê³  ìˆìŠµë‹ˆë‹¤.

**1.2 ì•ˆì •ì„± ë° ë°©ì–´ë ¥ ë¶„ì„ (60 / 100): ê¸°ìˆ ì£¼ íŠ¹ìœ ì˜ ë³€ë™ì„±**

ëŒ€ë¶€ë¶„ì˜ ì¢…ëª©ì´ ì„±ì¥ ë‹¨ê³„ì˜ ê¸°ìˆ  ê¸°ì—…ë“¤ë¡œ êµ¬ì„±ë˜ì–´ ìˆì–´ ì‹œì¥ ë³€ë™ì„±ì— ë…¸ì¶œë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì•ˆì •ì ì¸ í˜„ê¸ˆíë¦„ì„ ì°½ì¶œí•˜ëŠ” ê¸°ì—…ì˜ ë¹„ì¤‘ì„ ë†’ì´ë©´ ë°©ì–´ë ¥ì„ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**1.3 ì „ëµì  ì¼ê´€ì„± ë¶„ì„ (80 / 100): ëª…í™•í•œ íˆ¬ì í…Œë§ˆ**

'ê¸°ìˆ  í˜ì‹ 'ì´ë¼ëŠ” ì¼ê´€ëœ íˆ¬ì ì² í•™ì´ í¬íŠ¸í´ë¦¬ì˜¤ ì „ë°˜ì— ë°˜ì˜ë˜ì–´ ìˆì–´ ë†’ì€ ì „ëµì  ì¼ê´€ì„±ì„ ë³´ì—¬ì¤ë‹ˆë‹¤.

**[2] í¬íŠ¸í´ë¦¬ì˜¤ ê°•ì  ë° ì•½ì , ê·¸ë¦¬ê³  ê¸°íšŒ**

**ğŸ’ª ê°•ì **

- **ë¯¸ë˜ ê¸°ìˆ  íˆ¬ì:** ì°¨ì„¸ëŒ€ ê¸°ìˆ  ë¶„ì•¼ì˜ ì„ ë„ ê¸°ì—…ë“¤ì— ëŒ€í•œ ì „ëµì  íˆ¬ì
- **ëª…í™•í•œ íˆ¬ì ì² í•™:** ì¼ê´€ëœ ê¸°ìˆ  í˜ì‹  í…Œë§ˆë¡œ í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±

**ğŸ“‰ ì•½ì **

- **ë†’ì€ ë³€ë™ì„±:** ê¸°ìˆ ì£¼ ì¤‘ì‹¬ì˜ í¬íŠ¸í´ë¦¬ì˜¤ë¡œ ì¸í•œ ì‹œì¥ ë³€ë™ì„± ë…¸ì¶œ
- **ì„¹í„° ì§‘ì¤‘:** íŠ¹ì • ê¸°ìˆ  ë¶„ì•¼ì— ëŒ€í•œ ì˜ì¡´ë„ê°€ ë†’ìŒ

**ğŸ’¡ ê¸°íšŒ ë° ê°œì„  ë°©ì•ˆ**

- **ì•ˆì •ì„± ë³´ê°•:** ì•ˆì •ì ì¸ ë°°ë‹¹ì£¼ë‚˜ ëŒ€í˜•ì£¼ì˜ ë¹„ì¤‘ì„ ë†’ì—¬ í¬íŠ¸í´ë¦¬ì˜¤ ì•ˆì •ì„± ê°œì„ 
- **ì§€ì—­ ë¶„ì‚°:** ê¸€ë¡œë²Œ ê¸°ìˆ  ê¸°ì—…ë“¤ë¡œ ì§€ì—­ì  ë¶„ì‚° íˆ¬ì í™•ëŒ€

**[3] ê°œë³„ ì¢…ëª© ë¦¬ë‹ˆì•„ ìŠ¤ì½”ì–´ ìƒì„¸ ë¶„ì„**

**3.1 ìŠ¤ì½”ì–´ ìš”ì•½ í…Œì´ë¸”**

| ì£¼ì‹ | Overall (100ì  ë§Œì ) | í€ë”ë©˜íƒˆ | ê¸°ìˆ  ì ì¬ë ¥ | ê±°ì‹œê²½ì œ | ì‹œì¥ì‹¬ë¦¬ | CEO/ë¦¬ë”ì‹­ |
| --- | --- | --- | --- | --- | --- | --- |
| **ìƒ˜í”Œ ê¸°ìˆ ì£¼ A** | **80** | 75 | 90 | 75 | 85 | 85 |
| **ìƒ˜í”Œ ê¸°ìˆ ì£¼ B** | **78** | 80 | 85 | 70 | 80 | 85 |

**3.2 ê°œë³„ ì¢…ëª© ë¶„ì„ ì¹´ë“œ**

**1. ìƒ˜í”Œ ê¸°ìˆ ì£¼ A - Overall: 80 / 100**

- **í€ë”ë©˜íƒˆ (75/100):** ê¾¸ì¤€í•œ ë§¤ì¶œ ì„±ì¥ê³¼ ìˆ˜ìµì„± ê°œì„ ì„ ë³´ì—¬ì£¼ëŠ” ì•ˆì •ì ì¸ ì¬ë¬´ êµ¬ì¡°
- **ê¸°ìˆ  ì ì¬ë ¥ (90/100):** ì°¨ì„¸ëŒ€ ê¸°ìˆ  ë¶„ì•¼ì—ì„œ ë…ë³´ì ì¸ ê¸°ìˆ ë ¥ê³¼ íŠ¹í—ˆ í¬íŠ¸í´ë¦¬ì˜¤ ë³´ìœ 
- **ê±°ì‹œê²½ì œ (75/100):** ê¸€ë¡œë²Œ ë””ì§€í„¸ ì „í™˜ ê°€ì†í™”ì˜ ì§ì ‘ì ì¸ ìˆ˜í˜œ
- **ì‹œì¥ì‹¬ë¦¬ (85/100):** ê¸°ìˆ  í˜ì‹ ì— ëŒ€í•œ ì‹œì¥ì˜ ë†’ì€ ê¸°ëŒ€ê°
- **CEO/ë¦¬ë”ì‹­ (85/100):** ë¹„ì „ ìˆëŠ” ë¦¬ë”ì‹­ê³¼ í˜ì‹ ì ì¸ ê²½ì˜ ì „ëµ"""
